---
version: "2.1"

services:
  runner:
    image: golang:1.12.1
    working_dir: /go/src/github.com/jlevesy/sind
    volumes:
      - ../../:/go/src/github.com/jlevesy/sind
    environment:
      DOCKER_HOST: tcp://docker:2375
    depends_on:
      - docker
    command:
      - go
      - test
      - -count=1
      - -v
      - ./pkg/test

  docker:
    image: docker:18.09-dind
    privileged: true
